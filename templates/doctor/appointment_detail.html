{% extends "base.html" %}
{% block page_title %}Appointment Detail{% endblock %}
{% block main_content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h2>Appointment Detail</h2>
  <a class="btn btn-outline-primary" href="{{ url_for('route_show_doctor_appointments_list') }}">Back</a>
</div>
<div class="card p-3 mb-3">
  <p><strong>Patient:</strong> {{ appointment.patient_name }} ({{ appointment.patient_id }})</p>
  <p><strong>Date:</strong> {{ appointment.appointment_date }} <strong>Time:</strong> {{ appointment.appointment_time }}</p>
  <p><strong>Status:</strong> <span class="status-{{ appointment.status|lower }}">{{ appointment.status }}</span></p>
</div>
{% if appointment and appointment.status == 'Booked' %}
<form method="post">
  <div class="mb-3">
    <label class="form-label">Action</label>
    <select name="action" class="form-select">
      <option value="">No change</option>
      <option value="Completed">Mark Completed</option>
      <option value="Cancelled">Mark Cancelled</option>
    </select>
  </div>
  <div class="mb-3"><label class="form-label">Diagnosis</label><input name="diagnosis" class="form-control"></div>
  <div class="mb-3"><label class="form-label">Prescription</label><input name="prescription" class="form-control"></div>
  <div class="mb-3"><label class="form-label">Notes</label><textarea name="doctor_notes" class="form-control"></textarea></div>
  <div class="d-grid"><button class="btn btn-primary-action" type="submit">Save Result / Status</button></div>
</form>
{% else %}
<div class="alert alert-secondary">No modifications allowed â€” this appointment is <strong>{{ appointment.status if appointment else 'Unknown' }}</strong>.</div>
{% endif %}
<hr>
<h5>Previous Results</h5>
<ul class="list-group">
  {% for t in treatments %}
  <li class="list-group-item">
    <strong>Diagnosis:</strong> {{ t.diagnosis }} <br>
    <strong>Prescription:</strong> {{ t.prescription }} <br>
    <strong>Notes:</strong> {{ t.doctor_notes }}
  </li>
  {% endfor %}
  {% if treatments|length == 0 %}
  <li class="list-group-item">No results</li>
  {% endif %}
</ul>
{% endblock %}
